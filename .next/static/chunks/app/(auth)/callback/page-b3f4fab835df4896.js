(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[787],{37126:function(t,e,a){Promise.resolve().then(a.bind(a,29716))},29716:function(t,e,a){"use strict";a.r(e),a.d(e,{default:function(){return AuthCallback}});var n=a(57437),i=a(2265),s=a(24033),o=a(97823),r=a(92785);function AuthCallback(){let t=(0,s.useRouter)(),{setUser:e}=(0,r.t)();return(0,i.useEffect)(()=>{let handleAuthCallback=async()=>{try{let{data:s,error:r}=await o.O.auth.getSession();if(r){console.error("Auth callback error:",r),t.push("/login?error=auth_failed");return}if(s.session){var a,n,i;let o=s.session.user;localStorage.setItem("token",s.session.access_token);let r={id:o.id,email:o.email,full_name:(null===(a=o.user_metadata)||void 0===a?void 0:a.full_name)||(null===(n=o.user_metadata)||void 0===n?void 0:n.name)||"",company_name:(null===(i=o.user_metadata)||void 0===i?void 0:i.company_name)||null,subscription_plan:"free",leads_quota:100,leads_used:0,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};e(r),t.push("/dashboard")}else t.push("/login")}catch(e){console.error("Auth callback error:",e),t.push("/login?error=auth_failed")}};handleAuthCallback()},[t,e]),(0,n.jsx)("div",{className:"flex h-screen items-center justify-center",children:(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),(0,n.jsx)("span",{className:"text-gray-600",children:"Completing sign in..."})]})})}},6454:function(t,e,a){"use strict";a.d(e,{BG:function(){return o},Yu:function(){return l},fn:function(){return r},iJ:function(){return s}});var n=a(54829);let i=n.Z.create({baseURL:"https://xcape.onrender.com",headers:{"Content-Type":"application/json"}});i.interceptors.request.use(t=>{{let e=localStorage.getItem("token");e&&(t.headers.Authorization="Bearer ".concat(e))}return t}),i.interceptors.response.use(t=>t,t=>{var e,a,n;if((null===(e=t.response)||void 0===e?void 0:e.status)===401){let e=null===(n=t.config)||void 0===n?void 0:null===(a=n.url)||void 0===a?void 0:a.includes("/api/auth/");e||(localStorage.removeItem("token"),window.location.href="/login")}return Promise.reject(t)});let s={login:t=>i.post("/api/auth/login",t).then(t=>t.data),register:t=>i.post("/api/auth/register",t).then(t=>t.data),logout:()=>i.post("/api/auth/logout").then(t=>t.data),getProfile:()=>i.get("/api/users/profile").then(t=>t.data),updateProfile:t=>i.put("/api/users/profile",t).then(t=>t.data),forgotPassword:t=>i.post("/api/auth/forgot-password",{email:t}).then(t=>t.data),resetPassword:t=>i.post("/api/auth/reset-password",t).then(t=>t.data)},o={getProfile:()=>i.get("/api/users/profile").then(t=>t.data),updateProfile:t=>i.put("/api/users/profile",t).then(t=>t.data),getStats:()=>i.get("/api/users/stats").then(t=>t.data)},r={generateJob:t=>i.post("/api/leads/generate-job",t).then(t=>t.data),getJobStatus:t=>i.get("/api/leads/job/".concat(t,"/status")).then(t=>t.data),getUserJobs:()=>i.get("/api/leads/jobs").then(t=>t.data),generate:t=>i.post("/api/leads/generate",t).then(t=>t.data),getGenerationStatus:t=>i.get("/api/leads/status/".concat(t)).then(t=>t.data),getAll:t=>i.get("/api/leads",{params:t}).then(t=>t.data),getById:t=>i.get("/api/leads/".concat(t)).then(t=>t.data),update:(t,e)=>i.put("/api/leads/".concat(t),e).then(t=>t.data),delete:t=>i.delete("/api/leads/".concat(t)).then(t=>t.data),getTags:()=>i.get("/api/tags").then(t=>t.data),createTag:t=>i.post("/api/tags",t).then(t=>t.data),updateTag:(t,e)=>i.put("/api/tags/".concat(t),e).then(t=>t.data),deleteTag:t=>i.delete("/api/tags/".concat(t)).then(t=>t.data),tagLead:(t,e)=>i.post("/api/tags/".concat(e,"/leads/").concat(t)).then(t=>t.data),untagLead:(t,e)=>i.delete("/api/tags/".concat(e,"/leads/").concat(t)).then(t=>t.data)},l={getOverview:()=>i.get("/api/analytics/overview").then(t=>t.data),getStatusDistribution:()=>i.get("/api/analytics/status-distribution").then(t=>t.data),getSourceBreakdown:()=>i.get("/api/analytics/source-breakdown").then(t=>t.data),getIndustryBreakdown:()=>i.get("/api/analytics/industry-breakdown").then(t=>t.data),getDailyStats:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:7;return i.get("/api/analytics/daily-stats",{params:{days:t}}).then(t=>t.data)},getGeographicDistribution:()=>i.get("/api/analytics/geographic-distribution").then(t=>t.data),getScoreDistribution:()=>i.get("/api/analytics/score-distribution").then(t=>t.data),getRecentActivity:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5;return i.get("/api/analytics/recent-activity",{params:{limit:t}}).then(t=>t.data)}}},97823:function(t,e,a){"use strict";a.d(e,{O:function(){return r}});var n=a(1492),i=a(62601);let s=i.env.NEXT_PUBLIC_SUPABASE_URL,o=i.env.NEXT_PUBLIC_SUPABASE_ANON_KEY,r=(0,n.eI)(s,o)},92785:function(t,e,a){"use strict";a.d(e,{t:function(){return o}});var n=a(94660),i=a(74810),s=a(6454);let o=(0,n.Ue)()((0,i.tJ)((t,e)=>({user:null,token:null,isLoading:!1,isAuthenticated:!1,initialize:()=>{let a=e();a.token&&a.user?(localStorage.setItem("token",a.token),t({isAuthenticated:!0,isLoading:!1})):(localStorage.removeItem("token"),t({user:null,token:null,isAuthenticated:!1,isLoading:!1}))},login:async e=>{t({isLoading:!0});try{let a=await s.iJ.login(e);localStorage.setItem("token",a.token),t({user:a.user,token:a.token,isAuthenticated:!0,isLoading:!1})}catch(e){throw t({isLoading:!1}),e}},register:async e=>{t({isLoading:!0});try{await s.iJ.register(e),t({isLoading:!1})}catch(e){throw t({isLoading:!1}),e}},logout:async()=>{try{await s.iJ.logout()}catch(t){}finally{localStorage.removeItem("token"),t({user:null,token:null,isAuthenticated:!1,isLoading:!1})}},setUser:e=>{t({user:e,isAuthenticated:!0})},setLoading:e=>{t({isLoading:e})}}),{name:"auth-store",partialize:t=>({user:t.user,token:t.token,isAuthenticated:t.isAuthenticated}),onRehydrateStorage:()=>t=>{t&&t.initialize()}}))},24033:function(t,e,a){t.exports=a(50094)}},function(t){t.O(0,[737,166,492,971,472,744],function(){return t(t.s=37126)}),_N_E=t.O()}]);